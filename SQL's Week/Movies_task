-- 1. Titles of all movies from 2008
SELECT title FROM movies WHERE year >= 2008;

-- 2. Birth year of Emma Stone
SELECT birth FROM people WHERE name = 'Emma Stone';

-- 3. Titles of all movies since 2018, in alphabetical order
SELECT title FROM movies WHERE year >= 2018 ORDER BY title  ASC ;

-- 4. Number of movies with a 10.0 rating
SELECT COUNT (*) FROM ratings WHERE rating = 10;

-- 5. Titles and years of all Harry Potter movies, in chronological order (title beginning with "Harry Potter and the ...")
SELECT title , year FROM movies WHERE title like 'Harry Potter%' ORDER BY year ASC;

-- 6. Average rating of movies in 2012
SELECT AVG(rating) FROM ratings WHERE (SELECT id from movies where year = 2012 );

-- 7. All movies and ratings from 2010, in decreasing order by rating (alphabetical for those with same rating)
SELECT title , rating FROM movies join ratings on movies.id = ratings.movie_id WHERE movies.year = 2010 ORDER BY  ratings.rating DESC  , movies.title  ASC;

-- 8. Names of people who starred in Toy Story
SELECT
    movies.title,
    people.name
FROM
    movies
    JOIN stars ON movies.id = stars.movie_id
    JOIN people ON stars.person_id = people.id
WHERE
    movies.title = 'Toy Story'
LIMIT
    5;


-- 9. Names of all people who starred in a movie released in 2004, ordered by birth year
SELECT
    people.name AS NAME,
    people.birth AS BOD
FROM
    people
    JOIN stars ON people.id = stars.person_id
    JOIN movies ON stars.movie_id = movies.id
WHERE
    movies.year = 2004
ORDER BY
    people.birth ASC;


-- 10. Names of all directors who have directed a movie that got a rating of at least 9.0
SELECT
    people.name
FROM
    people
    JOIN directors ON people.id = directors.person_id
    JOIN movies ON movies.id = directors.movie_id
    JOIN ratings ON movies.id = ratings.movie_id
WHERE
    ratings.rating >= 9
LIMIT
    5;


-- 11. Titles of the five highest rated movies (in order) that Chadwick Boseman starred in, starting with the highest rated
SELECT DISTINCT
    movies.title
FROM
    movies
    JOIN stars ON movies.id = stars.movie_id
    JOIN people ON people.id = stars.person_id
    JOIN ratings ON movies.id = ratings.movie_id
WHERE
    people.name = 'Chadwick Boseman'
ORDER BY
    ratings.rating Desc
LIMIT
    5;


-- 12. Titles of all of movies in which both Jennifer Lawrence and Bradley Cooper starred
SELECT
    movies.title
FROM
    movies
    JOIN stars ON movies.id = stars.movie_id
    JOIN people ON people.id = stars.person_id
WHERE
    name = 'Jennifer Lawrence'
    AND name = 'Bradley Cooper';


-- =======================
-- 13. Names of all people who starred in a movie in which Kevin Bacon also starred
SELECT
    people.name
FROM
    people
    JOIN stars ON people.id = stars.person_id
    JOIN movies ON movies.id = stars.movie_id
WHERE
    movies.id = (
        SELECT
            movie_id
        FROM
            stars
        WHERE
            person_id = (
                SELECT
                    id
                FROM
                    people
                WHERE
                    name = 'Kevin Bacon'
            )
    )
    AND people.id != 'Kevin Bacon';
